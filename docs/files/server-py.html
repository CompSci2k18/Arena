<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>ArenaServer</title><link rel="stylesheet" type="text/css" href="../styles/main.css"><script language=JavaScript src="../javascript/main.js"></script><script language=JavaScript src="../javascript/prettify.js"></script><script language=JavaScript src="../javascript/searchdata.js"></script></head><body class="ContentPage" onLoad="NDOnLoad();prettyPrint();"><script language=JavaScript><!--
if (browserType) {document.write("<div class=" + browserType + ">");if (browserVer) {document.write("<div class=" + browserVer + ">"); }}// --></script>

<!--  Generated by Natural Docs, version 1.52 -->
<!--  http://www.naturaldocs.org  -->

<!-- saved from url=(0026)http://www.naturaldocs.org -->




<div id=Content><div class="CClass"><div class=CTopic id=MainTopic><h1 class=CTitle><a name="ArenaServer"></a>ArenaServer</h1><div class=CBody><p>The threaded server that makes up the back end for the arena</p><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable><tr class="SMain"><td class=SEntry><a href="#ArenaServer" >ArenaServer</a></td><td class=SDescription>The threaded server that makes up the back end for the arena</td></tr><tr class="SGroup SIndent1"><td class=SEntry><a href="#ArenaServer.Types" >Types</a></td><td class=SDescription></td></tr><tr class="SType SIndent2 SMarked"><td class=SEntry><a href="#ArenaServer.Tuple" >Tuple</a></td><td class=SDescription>Python&rsquo;s tuple</td></tr><tr class="SType SIndent2"><td class=SEntry><a href="#ArenaServer.List" >List</a></td><td class=SDescription>Python&rsquo;s list</td></tr><tr class="SType SIndent2 SMarked"><td class=SEntry><a href="#ArenaServer.Socket" >Socket</a></td><td class=SDescription>Python&rsquo;s socket object from the socket module</td></tr><tr class="SGroup SIndent1"><td class=SEntry><a href="#ArenaServer.Variables" >Variables</a></td><td class=SDescription></td></tr><tr class="SVariable SIndent2 SMarked"><td class=SEntry><a href="#ArenaServer.host" >host</a></td><td class=SDescription>The address of the host. </td></tr><tr class="SVariable SIndent2"><td class=SEntry><a href="#ArenaServer.port" >port</a></td><td class=SDescription>The port number the socket will bind to. </td></tr><tr class="SVariable SIndent2 SMarked"><td class=SEntry><a href="#ArenaServer.sock" >sock</a></td><td class=SDescription>The socket object the server listens on</td></tr><tr class="SVariable SIndent2"><td class=SEntry><a href="#ArenaServer.started" >started</a></td><td class=SDescription>False while the server is still in the lobby, True once game starts</td></tr><tr class="SVariable SIndent2 SMarked"><td class=SEntry><a href="#ArenaServer.host_start" >host_start</a></td><td class=SDescription>False until the host clicks the Start Game button.</td></tr><tr class="SVariable SIndent2"><td class=SEntry><a href="#ArenaServer.players" >players</a></td><td class=SDescription><a href="#ArenaServer.List" class=LType id=link1 onMouseOver="ShowTip(event, 'tt1', 'link1')" onMouseOut="HideTip('tt1')">List</a> of player JSON objects in the lobby</td></tr><tr class="SVariable SIndent2 SMarked"><td class=SEntry><a href="#ArenaServer.lobby_size" >lobby_size</a></td><td class=SDescription>Maintaining the amount of players currently in the lobby</td></tr><tr class="SVariable SIndent2"><td class=SEntry><a href="#ArenaServer.coords" >coords</a></td><td class=SDescription><a href="#ArenaServer.List" class=LType id=link2 onMouseOver="ShowTip(event, 'tt1', 'link2')" onMouseOut="HideTip('tt1')">List</a> of <a href="#ArenaServer.coordinate" class=LVariable id=link3 onMouseOver="ShowTip(event, 'tt2', 'link3')" onMouseOut="HideTip('tt2')">coordinate</a> tuples players can spawn in</td></tr><tr class="SVariable SIndent2 SMarked"><td class=SEntry><a href="#ArenaServer.coordinate" >coordinate</a></td><td class=SDescription>Tuples of (x, y) coordinates</td></tr><tr class="SVariable SIndent2"><td class=SEntry><a href="#ArenaServer.player_objects" >player_objects</a></td><td class=SDescription><a href="#ArenaServer.List" class=LType id=link4 onMouseOver="ShowTip(event, 'tt1', 'link4')" onMouseOut="HideTip('tt1')">List</a> of the <a href="scripts/arena-js.html#Player" class=LClass id=link5 onMouseOver="ShowTip(event, 'tt3', 'link5')" onMouseOut="HideTip('tt3')">Player</a> objects created in Javascript for all players in game</td></tr><tr class="SGroup SIndent1"><td class=SEntry><a href="#ArenaServer.Functions" >Functions</a></td><td class=SDescription></td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#ArenaServer.ArenaServer" >ArenaServer</a></td><td class=SDescription>Initialises the server and binds it to the host and port specified</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#ArenaServer.Close" >Close</a></td><td class=SDescription>Closes the server and releases the socket</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#ArenaServer.Listen" >Listen</a></td><td class=SDescription>Listen for incoming connections and pass them off to the handler methods in a new thread</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#ArenaServer.Handle_Lobby_Connection" >Handle Lobby Connection</a></td><td class=SDescription>Method run in a separate thread to handle requests while the game is still in the lobby state</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#ArenaServer.Lobby_Join" >Lobby Join</a></td><td class=SDescription>Handler for player joining the lobby</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#ArenaServer.Lobby_Query" >Lobby Query</a></td><td class=SDescription>Handler for AJAX querying the players in the lobby</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#ArenaServer.Lobby_Start" >Lobby Start</a></td><td class=SDescription>Handler for the host starting the game</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#ArenaServer.Handle_Game_Connection" >Handle Game Connection</a></td><td class=SDescription>Method run in a separate thread to handle requests while the game is running</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#ArenaServer.Game_Start_Up" >Game Start Up</a></td><td class=SDescription>Handler for players arriving at the game.html page for syncing up player data</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#ArenaServer.Game_Update" >Game Update</a></td><td class=SDescription>Handler for the AJAX updating player data for all players connected</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#ArenaServer.Generate_Colour" >Generate Colour</a></td><td class=SDescription>Generate a random colour for a player</td></tr></table></div></div><!--END_ND_SUMMARY--></div></div></div>

<div class="CGroup"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.Types"></a>Types</h3></div></div>

<div class="CType"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.Tuple"></a>Tuple</h3><div class=CBody><p>Python&rsquo;s tuple</p></div></div></div>

<div class="CType"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.List"></a>List</h3><div class=CBody><p>Python&rsquo;s list</p></div></div></div>

<div class="CType"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.Socket"></a>Socket</h3><div class=CBody><p>Python&rsquo;s socket object from the socket module</p></div></div></div>

<div class="CGroup"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.Variables"></a>Variables</h3></div></div>

<div class="CVariable"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.host"></a>host</h3><div class=CBody><p>The address of the host.&nbsp; Generated by this program</p></div></div></div>

<div class="CVariable"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.port"></a>port</h3><div class=CBody><p>The port number the socket will bind to.&nbsp; Default 44444.</p></div></div></div>

<div class="CVariable"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.sock"></a>sock</h3><div class=CBody><p>The socket object the server listens on</p></div></div></div>

<div class="CVariable"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.started"></a>started</h3><div class=CBody><p>False while the server is still in the lobby, True once game starts</p></div></div></div>

<div class="CVariable"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.host_start"></a>host_start</h3><div class=CBody><p>False until the host clicks the Start Game button.</p></div></div></div>

<div class="CVariable"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.players"></a>players</h3><div class=CBody><p><a href="#ArenaServer.List" class=LType id=link6 onMouseOver="ShowTip(event, 'tt1', 'link6')" onMouseOut="HideTip('tt1')">List</a> of player JSON objects in the lobby</p></div></div></div>

<div class="CVariable"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.lobby_size"></a>lobby_size</h3><div class=CBody><p>Maintaining the amount of players currently in the lobby</p></div></div></div>

<div class="CVariable"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.coords"></a>coords</h3><div class=CBody><p><a href="#ArenaServer.List" class=LType id=link7 onMouseOver="ShowTip(event, 'tt1', 'link7')" onMouseOut="HideTip('tt1')">List</a> of <a href="#ArenaServer.coordinate" class=LVariable id=link8 onMouseOver="ShowTip(event, 'tt2', 'link8')" onMouseOut="HideTip('tt2')">coordinate</a> tuples players can spawn in</p></div></div></div>

<div class="CVariable"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.coordinate"></a>coordinate</h3><div class=CBody><p>Tuples of (x, y) coordinates</p></div></div></div>

<div class="CVariable"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.player_objects"></a>player_objects</h3><div class=CBody><p><a href="#ArenaServer.List" class=LType id=link9 onMouseOver="ShowTip(event, 'tt1', 'link9')" onMouseOut="HideTip('tt1')">List</a> of the <a href="scripts/arena-js.html#Player" class=LClass id=link10 onMouseOver="ShowTip(event, 'tt3', 'link10')" onMouseOut="HideTip('tt3')">Player</a> objects created in Javascript for all players in game</p></div></div></div>

<div class="CGroup"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.Functions"></a>Functions</h3></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.ArenaServer"></a>ArenaServer</h3><div class=CBody><p>Initialises the server and binds it to the host and port specified</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>string host</td><td class=CDLDescription>The host ip of the server.&nbsp; Is usually the local machine</td></tr><tr><td class=CDLEntry>int port</td><td class=CDLDescription>The port number of the server.&nbsp; Default is 44444</td></tr></table></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.Close"></a>Close</h3><div class=CBody><p>Closes the server and releases the socket</p></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.Listen"></a>Listen</h3><div class=CBody><p>Listen for incoming connections and pass them off to the handler methods in a new thread</p></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.Handle_Lobby_Connection"></a>Handle Lobby Connection</h3><div class=CBody><p>Method run in a separate thread to handle requests while the game is still in the lobby state</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>&lt;Socket&gt; client</td><td class=CDLDescription>The socket to send response through.</td></tr><tr><td class=CDLEntry>&lt;Tuple&gt;[string, int] address</td><td class=CDLDescription>The address and port of the client.</td></tr></table><h4 class=CHeading>Returns</h4><p>The results of <a href="#ArenaServer.Lobby_Join" class=LFunction id=link11 onMouseOver="ShowTip(event, 'tt4', 'link11')" onMouseOut="HideTip('tt4')">Lobby Join</a>, <a href="#ArenaServer.Lobby_Query" class=LFunction id=link12 onMouseOver="ShowTip(event, 'tt5', 'link12')" onMouseOut="HideTip('tt5')">Lobby Query</a>, or <a href="#ArenaServer.Lobby_Start" class=LFunction id=link13 onMouseOver="ShowTip(event, 'tt6', 'link13')" onMouseOut="HideTip('tt6')">Lobby Start</a>, depending on the message from the client</p></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.Lobby_Join"></a>Lobby Join</h3><div class=CBody><p>Handler for player joining the lobby</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>&lt;Socket&gt; client</td><td class=CDLDescription>The socket to send response through</td></tr><tr><td class=CDLEntry>&lt;Tuple&gt;[string, int] address</td><td class=CDLDescription>The address and port of the client</td></tr><tr><td class=CDLEntry>string msg</td><td class=CDLDescription>The msg that was sent by the client Includes the username that the player has chosen</td></tr></table><h4 class=CHeading>Returns</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>string response</td><td class=CDLDescription>Either &lsquo;lobby full&rsquo; if the lobby is full, or &lsquo;joined=&rsquo; + the index of the player in the array <a href="#ArenaServer.players" class=LVariable id=link14 onMouseOver="ShowTip(event, 'tt7', 'link14')" onMouseOut="HideTip('tt7')">players</a></td></tr></table></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.Lobby_Query"></a>Lobby Query</h3><div class=CBody><p>Handler for AJAX querying the players in the lobby</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>&lt;Socket&gt; client</td><td class=CDLDescription>The socket to send response through</td></tr><tr><td class=CDLEntry>&lt;Tuple&gt;[string, int] address</td><td class=CDLDescription>The address and port of the client</td></tr><tr><td class=CDLEntry>string msg</td><td class=CDLDescription>The msg that was sent by the client Includes the index of the player in the list of players</td></tr></table><h4 class=CHeading>Returns</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>&lt;List&gt; players</td><td class=CDLDescription>List of player objects currently in the lobby</td></tr><tr><td class=CDLEntry>boolean started</td><td class=CDLDescription>False if the game hasn&rsquo;t started, True otherwise</td></tr></table></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.Lobby_Start"></a>Lobby Start</h3><div class=CBody><p>Handler for the host starting the game</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>&lt;Socket&gt; client</td><td class=CDLDescription>The socket to send response through</td></tr><tr><td class=CDLEntry>&lt;Tuple&gt;[string, int] address</td><td class=CDLDescription>The address and port of the client</td></tr><tr><td class=CDLEntry>string msg</td><td class=CDLDescription>The msg that was sent by the client Includes the index of the player in the list of players</td></tr></table><h4 class=CHeading>Returns</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>boolean ready</td><td class=CDLDescription>True if all players in the lobby are ready to start, else False</td></tr></table></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.Handle_Game_Connection"></a>Handle Game Connection</h3><div class=CBody><p>Method run in a separate thread to handle requests while the game is running</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>&lt;Socket&gt; client</td><td class=CDLDescription>The socket to send response through.</td></tr><tr><td class=CDLEntry>&lt;Tuple&gt;[string, int] address</td><td class=CDLDescription>The address and port of the client.</td></tr><tr><td class=CDLEntry>boolean repeat</td><td class=CDLDescription>Due to issues with http sockets, allow one re-run of this handler to ensure message is received</td></tr></table><h4 class=CHeading>Returns</h4><p>The results of <a href="#ArenaServer.Game_Start_Up" class=LFunction id=link15 onMouseOver="ShowTip(event, 'tt8', 'link15')" onMouseOut="HideTip('tt8')">Game Start Up</a> or <a href="#ArenaServer.Game_Update" class=LFunction id=link16 onMouseOver="ShowTip(event, 'tt9', 'link16')" onMouseOut="HideTip('tt9')">Game Update</a>, depending on the message from the client</p></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.Game_Start_Up"></a>Game Start Up</h3><div class=CBody><p>Handler for players arriving at the game.html page for syncing up player data</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>&lt;Socket&gt; client</td><td class=CDLDescription>The socket to send response through</td></tr><tr><td class=CDLEntry>&lt;Tuple&gt;[string, int] address</td><td class=CDLDescription>The address and port of the client</td></tr><tr><td class=CDLEntry>string msg</td><td class=CDLDescription>The msg that was sent by the client Includes the index of the player in the list of players</td></tr></table><h4 class=CHeading>Returns</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>array players</td><td class=CDLDescription>Starting data for all players, to be turned into <a href="scripts/arena-js.html#Player" class=LClass id=link17 onMouseOver="ShowTip(event, 'tt3', 'link17')" onMouseOut="HideTip('tt3')">Player</a> objects in the JavaScript</td></tr><tr><td class=CDLEntry>boolean ready</td><td class=CDLDescription>True if all players have run this method, else False</td></tr></table></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.Game_Update"></a>Game Update</h3><div class=CBody><p>Handler for the AJAX updating player data for all players connected</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>&lt;Socket&gt; client</td><td class=CDLDescription>The socket to send response through</td></tr><tr><td class=CDLEntry>&lt;Tuple&gt;[string, int] address</td><td class=CDLDescription>The address and port of the client</td></tr><tr><td class=CDLEntry>string msg</td><td class=CDLDescription>The msg that was sent by the client Includes a JSON string of the local players data</td></tr></table><h4 class=CHeading>Returns</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>array players</td><td class=CDLDescription>The current status of all players in the game</td></tr></table></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="ArenaServer.Generate_Colour"></a>Generate Colour</h3><div class=CBody><p>Generate a random colour for a player</p><h4 class=CHeading>Returns</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>string colour</td><td class=CDLDescription>Random 6-digit hexadecimal string representing a colour value</td></tr></table></div></div></div>

</div><!--Content-->


<div id=Footer><a href="http://www.naturaldocs.org">Generated by Natural Docs</a></div><!--Footer-->


<div id=Menu><div class=MEntry><div class=MFile><a href="scripts/arena-js.html">Arena.js</a></div></div><div class=MEntry><div class=MFile id=MSelected>ArenaServer</div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent1')">Index</a><div class=MGroupContent id=MGroupContent1><div class=MEntry><div class=MIndex><a href="../index/General.html">Everything</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Classes.html">Classes</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Functions.html">Functions</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Variables.html">Variables</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Types.html">Types</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Files.html">Files</a></div></div></div></div></div><script type="text/javascript"><!--
var searchPanel = new SearchPanel("searchPanel", "HTML", "../search");
--></script><div id=MSearchPanel class=MSearchPanelInactive><input type=text id=MSearchField value=Search onFocus="searchPanel.OnSearchFieldFocus(true)" onBlur="searchPanel.OnSearchFieldFocus(false)" onKeyUp="searchPanel.OnSearchFieldChange()"><select id=MSearchType onFocus="searchPanel.OnSearchTypeFocus(true)" onBlur="searchPanel.OnSearchTypeFocus(false)" onChange="searchPanel.OnSearchTypeChange()"><option  id=MSearchEverything selected value="General">Everything</option><option value="Classes">Classes</option><option value="Files">Files</option><option value="Functions">Functions</option><option value="Types">Types</option><option value="Variables">Variables</option></select></div></div><!--Menu-->



<!--START_ND_TOOLTIPS-->
<div class=CToolTip id="tt1"><div class=CType>Python&rsquo;s list</div></div><div class=CToolTip id="tt2"><div class=CVariable>Tuples of (x, y) coordinates</div></div><div class=CToolTip id="tt3"><div class=CClass>Objects representing the player controlled entity in the game</div></div><div class=CToolTip id="tt4"><div class=CFunction>Handler for player joining the lobby</div></div><div class=CToolTip id="tt5"><div class=CFunction>Handler for AJAX querying the players in the lobby</div></div><div class=CToolTip id="tt6"><div class=CFunction>Handler for the host starting the game</div></div><div class=CToolTip id="tt7"><div class=CVariable>List of player JSON objects in the lobby</div></div><div class=CToolTip id="tt8"><div class=CFunction>Handler for players arriving at the game.html page for syncing up player data</div></div><div class=CToolTip id="tt9"><div class=CFunction>Handler for the AJAX updating player data for all players connected</div></div><!--END_ND_TOOLTIPS-->




<div id=MSearchResultsWindow><iframe src="" frameborder=0 name=MSearchResults id=MSearchResults></iframe><a href="javascript:searchPanel.CloseResultsWindow()" id=MSearchResultsWindowClose>Close</a></div>


<script language=JavaScript><!--
if (browserType) {if (browserVer) {document.write("</div>"); }document.write("</div>");}// --></script></body></html>